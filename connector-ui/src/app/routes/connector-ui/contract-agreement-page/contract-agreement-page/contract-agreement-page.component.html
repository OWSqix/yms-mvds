<div id="wrapper">
  <!-- Page Title -->
  <h2>{{ 'contract_agreement_page.title' | translate }}</h2>
  
  <!-- Search and Filter Card -->
  <mat-card class="search-card">
    <!-- Mobile: Stack vertically at md breakpoint, Desktop: Horizontal layout -->
    <div class="flex flex-col md:flex-row gap-4 md:items-center">
      <!-- Search -->
      <mat-form-field
        class="search-form-field w-full md:flex-1"
        color="accent">
        <mat-label>{{
          'contract_agreement_page.search_agree' | translate
        }}</mat-label>
        <input matInput [formControl]="searchText" />
        <mat-icon matPrefix>search</mat-icon>
        <button
          *ngIf="searchText.value"
          mat-icon-button
          matSuffix
          (click)="searchText.setValue('')">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <!-- Termination status filter - Mobile: Full width, Desktop: Inline -->
      <div class="filter-container w-full md:w-auto flex justify-center md:justify-start items-center">
        <mat-button-toggle-group
          name="terminationFilter"
          [formControl]="terminationFilterControl"
          class="!h-auto">
          <mat-button-toggle
            value="ONGOING"
            (change)="onTerminationFilterChange()"
            class="!text-xs sm:!text-sm !px-2 sm:!px-4">
            <span class="hidden sm:inline">{{ 'contract_agreement_page.active_contracts' | translate }}</span>
            <span class="sm:hidden">{{ 'general.active' | translate }}</span>
          </mat-button-toggle>
          <mat-button-toggle
            value="TERMINATED"
            (change)="onTerminationFilterChange()"
            class="!text-xs sm:!text-sm !px-2 sm:!px-4">
            <span class="hidden sm:inline">{{ 'contract_agreement_page.terminated_contracts' | translate }}</span>
            <span class="sm:hidden">{{ 'general.terminated' | translate }}</span>
          </mat-button-toggle>
          <mat-button-toggle 
            value="all" 
            (change)="onTerminationFilterChange()"
            class="!text-xs sm:!text-sm !px-2 sm:!px-4">
            <span class="hidden sm:inline">{{ 'contract_agreement_page.all_contracts' | translate }}</span>
            <span class="sm:hidden">{{ 'general.all' | translate }}</span>
          </mat-button-toggle>
        </mat-button-toggle-group>
      </div>
    </div>
  </mat-card>

  <!-- Results Section -->
  <div class="results-section">
    <!-- Paginator -->
    <div class="pagination-container" *ngIf="page.isReady">
      <mat-paginator
        [hidePageSize]="true"
        [disabled]="true"
        [pageSize]="page.data.contractAgreements.length"
        [length]="page.data.numTotalContractAgreements"
        class="paginator-styled">
      </mat-paginator>
    </div>

    <div class="content-container">
      <loading-state *ngIf="page.isLoading" class="state-container"></loading-state>
      <error-state
        *ngIf="page.isError"
        class="state-container"
        [error]="page.errorOrUndefined"></error-state>
      <empty-state
        *ngIf="page.isReady && !page.data.numTotalContractAgreements"
        class="state-container"
        [emptyMessage]="
          'contract_agreement_page.no_agree' | translate
        "></empty-state>
      <empty-state
        *ngIf="
          page.isReady &&
          page.data.numTotalContractAgreements &&
          !(
            page.data.consumingContractAgreements.length +
            page.data.providingContractAgreements.length
          )
        "
        class="state-container"
        [emptyMessage]="
          'contract_agreement_page.no_agree_found' | translate
        "></empty-state>

      <div
        *ngIf="page.isReady && !!page.data.contractAgreements.length"
        class="agreements-container">
        <ng-container *ngIf="page.data.consumingContractAgreements.length">
          <horizontal-section-divider
            [text]="'contract_agreement_page.con_agree' | translate"
            class="section-divider">
          </horizontal-section-divider>

          <contract-agreement-cards
            [contractAgreements]="page.data.consumingContractAgreements"
            (contractAgreementClick)="
              onContractAgreementClick($event)
            "
            class="agreement-cards-grid"></contract-agreement-cards>
        </ng-container>

        <ng-container *ngIf="page.data.providingContractAgreements.length">
          <horizontal-section-divider
            [text]="'contract_agreement_page.prov_agree' | translate"
            class="section-divider">
          </horizontal-section-divider>

          <contract-agreement-cards
            [contractAgreements]="page.data.providingContractAgreements"
            (contractAgreementClick)="
              onContractAgreementClick($event)
            "
            class="agreement-cards-grid"></contract-agreement-cards>
        </ng-container>
      </div>
    </div>
  </div>
</div>
