<div id="wrapper">
  <!-- Page Title -->
  <h2>{{ 'catalog_browser_page.title' | translate }}</h2>
  
  <!-- Search Section Card -->
  <mat-card class="search-card">
    <!-- Mobile: Stack vertically at md breakpoint, Desktop: Horizontal layout -->
    <div class="flex flex-col md:flex-row gap-4 md:items-start">
      <!-- Search Bar -->
      <mat-form-field class="search-form-field w-full md:w-auto md:flex-1" color="accent">
        <mat-label>{{ 'catalog_browser_page.search' | translate }}</mat-label>
        <mat-icon matPrefix>search</mat-icon>
        <input matInput [formControl]="searchText" />
        <button
          *ngIf="searchText.value"
          mat-icon-button
          matSuffix
          (click)="searchText.setValue('')">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <!-- Connector Endpoints -->
      <mat-form-field
        class="search-form-field mat-hint-text-ellipsis w-full md:w-auto md:flex-1"
        color="accent"
        matBadgeColor="warn"
        [matBadge]="
          data.requestTotals.isSomeFailed
            ? data.requestTotals.numFailed
            : undefined
        ">
        <mat-label>{{
          'catalog_browser_page.con_endpoints' | translate
        }}</mat-label>
        <mat-icon matPrefix>link</mat-icon>
        <input
          matInput
          placeholder="https://counter-party/api/dsp?participantId=1234, ..."
          [(ngModel)]="customProviders"
          (input)="onCatalogUrlsChange()" />
        <mat-hint
          *ngIf="presetProvidersMessage"
          [matTooltip]="presetProvidersMessage"
          >{{ presetProvidersMessage }}</mat-hint
        >
        <button
          *ngIf="!data.requestTotals.isDone"
          matSuffix
          mat-icon-button
          [matTooltip]="'tooltip.details' | translate"
          (click)="onShowFetchDetails()">
          <mat-progress-spinner
            matSuffix
            class="!w-5 !h-5"
            diameter="20"
            color="primary"
            mode="indeterminate">
          </mat-progress-spinner>
        </button>
        <button
          *ngIf="data.requestTotals.isDone && data.requestTotals.isSomeFailed"
          matSuffix
          color="warn"
          mat-icon-button
          [matTooltip]="'tooltip.failed_details' | translate"
          (click)="onShowFetchDetails()">
          <mat-icon>warning</mat-icon>
        </button>
        <button
          *ngIf="data.requestTotals.isDone && !data.requestTotals.isSomeFailed"
          matSuffix
          color="primary"
          mat-icon-button
          [matTooltip]="'tooltip.details' | translate"
          (click)="onShowFetchDetails()">
          <mat-icon>info</mat-icon>
        </button>
      </mat-form-field>
    </div>
  </mat-card>

  <!-- Results Section -->
  <div class="results-section">
    <!-- Pagination -->
    <div class="pagination-container" *ngIf="data.requestTotals.isSomeReady">
      <mat-paginator
        [hidePageSize]="true"
        [disabled]="true"
        [pageSize]="data.filteredDataOffers.length"
        [length]="data.numTotalContractOffers"
        class="paginator-styled">
      </mat-paginator>
    </div>
    <div class="content-container">
      <empty-state
        *ngIf="data.requestTotals.isNothingReady && !data.requests.length"
        class="state-container"
        [emptyMessage]="
          'catalog_browser_page.enter_endpoints' | translate
        "></empty-state>
      <loading-state
        *ngIf="
          data.requestTotals.isNothingReady &&
          data.requests.length &&
          !data.requestTotals.isDone
        "
        class="state-container"></loading-state>
      <error-state
        *ngIf="data.requestTotals.isAllFailed"
        class="state-container"
        [error]="data.requestTotals.results[0].errorOrUndefined"></error-state>
      <empty-state
        *ngIf="data.requestTotals.isSomeReady && !data.filteredDataOffers.length"
        class="state-container"
        [emptyMessage]="
          'catalog_browser_page.no_contract_offers' | translate
        "></empty-state>
      
      <div
        *ngIf="data.requestTotals.isSomeReady && !!data.numTotalContractOffers"
        class="data-offers-grid">
        <data-offer-cards
          [dataOffers]="data.filteredDataOffers"
          (dataOfferClick)="onDataOfferClick($event)"></data-offer-cards>
      </div>
    </div>
  </div>
</div>
